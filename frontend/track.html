<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Laundry - Laundry Buddy</title>
    <link rel="stylesheet" href="track.css?v=2.0">
    <link rel="stylesheet" href="modal.css?v=2.0">
    <link rel="stylesheet" href="dark-mode.css?v=2.0">
    <link rel="stylesheet" href="responsive.css?v=1.0">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>

    <header>
        <div class="container navbar">
            <a href="home.html" class="logo">
                <i class='bx bxs-washer'></i>
                <span>Laundry Buddy</span>
            </a>
            <nav>
                <ul>
                    <li><a href="home.html">Home</a></li>
                    <li><a href="submit.html">Submit Laundry</a></li>
                    <li><a href="track.html" class="active">Track Laundry</a></li>
                    <li><a href="history.html">History</a></li>
                    <li><a href="support.html">Support</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
                <i class='bx bx-sun'></i>
                <span class="theme-toggle-slider"></span>
                <i class='bx bx-moon'></i>
            </button>
            <div class="header-actions">
                <a href="profile.html"><img src="assests/profile.png" alt="User Profile"></a>
            </div>
        </div>
    </header>

    <main>
        <div class="container track-container">
            <div class="tracking-info">
                <h1>Track Your Laundry</h1>
                
                <div class="input-group">
                    <input type="text" id="token-number" placeholder="Enter Token Number">
                </div>

                <div class="track-actions">
                    <button type="button" class="btn btn-secondary btn-icon" id="scan-qr-btn">
                        <i class='bx bx-qr-scan'></i>
                        Scan QR Code
                    </button>
                    <button type="button" class="btn btn-primary btn-icon hidden" id="show-qr-btn">
                        <i class='bx bx-qr'></i>
                        Show My QR
                    </button>
                </div>

                <div class="status-section hidden" id="status-section">
                    <h2>Laundry Status</h2>
                    <p class="status-text" id="status-text">Enter token to track</p>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="progress-fill"></div>
                    </div>
                    <div class="order-details" id="order-details"></div>
                </div>

                <button type="button" class="btn btn-primary hidden" id="notify-btn">Notify Me When Ready</button>
            </div>

            <div class="image-pane">
                <img src="assests/track.png" alt="Folded clothes">
            </div>
        </div>
    </main>

    <!-- QR Code Scanner Modal -->
    <div id="qr-scanner-modal">
        <div class="modal-content">
            <button id="close-scanner" aria-label="Close scanner">&times;</button>
            <h2>Scan QR Code</h2>
            <div id="qr-reader"></div>
            <div id="qr-scanner-status">Position the QR code within the frame</div>
            
            <div class="scanner-controls">
                <label for="qr-camera-select">Camera</label>
                <select id="qr-camera-select"></select>
                <div class="button-group">
                    <button id="qr-toggle-torch" class="btn btn-secondary" title="Toggle flash/torch"><i class='bx bx-flash'></i> Torch</button>
                    <button id="qr-retry" class="btn btn-secondary" title="Restart scanning"><i class='bx bx-refresh'></i> Retry</button>
                </div>
                <div class="options scanner-options">
                    <label class="scanner-option">
                        <input type="checkbox" id="qr-auto-resume">
                        Keep scanning after image success
                    </label>
                </div>
            </div>
            
            <button id="use-file-upload" class="btn btn-secondary">
                <i class='bx bx-upload'></i> Upload QR Code Image
            </button>
            
            <div class="qr-manual">
                <label for="qr-manual-input">Or paste token / QR content</label>
                <input id="qr-manual-input" type="text" placeholder="e.g., LB-20251025-1234">
                <div class="button-group">
                    <button id="qr-manual-submit" class="btn btn-secondary"><i class='bx bx-search'></i> Track Order</button>
                </div>
                <div id="qr-manual-error" class="qr-manual-error" aria-live="polite"></div>
            </div>
        </div>
    </div>

    <!-- Show QR Code Modal -->
    <div id="show-qr-modal">
        <div class="modal-content qr-show-modal">
            <button id="close-show-qr" aria-label="Close">&times;</button>
            <h2>Your Laundry QR Code</h2>
            <div class="qr-display-container">
                <div id="qr-code-display"></div>
                <p class="qr-token" id="qr-token-text"></p>
                <p class="qr-hint">Show this QR code to laundry staff</p>
            </div>
            <div class="qr-actions">
                <button id="download-qr" class="btn btn-primary"><i class='bx bx-download'></i> Download QR</button>
                <button id="share-qr" class="btn btn-secondary"><i class='bx bx-share-alt'></i> Share</button>
            </div>
        </div>
    </div>

    <!-- Include html5-qrcode library -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="assests/api-config.js"></script>
    <script src="assests/order-api.js"></script>
    <script src="assests/crypto-utils.js"></script>
    <script src="assests/auth.js"></script>
    <script src="assests/dark-mode.js"></script>
    <script src="assests/mobile-menu.js"></script>
    <script src="assests/keyboard-shortcuts.js"></script>
    <script src="assests/track.js?v=1.1"></script>

</body>
</html>