<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Integration Example - Laundry Buddy</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2563eb;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #2563eb;
        }
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1d4ed8;
        }
        .output {
            margin-top: 10px;
            padding: 10px;
            background: #e5e7eb;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success {
            color: #059669;
        }
        .error {
            color: #dc2626;
        }
        code {
            background: #e5e7eb;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß∫ Backend Integration Guide</h1>
        
        <div class="section">
            <h2>üìù Required Scripts</h2>
            <p>Add these scripts to your HTML files <strong>before</strong> other JavaScript files:</p>
            <code>&lt;script src="assests/api-config.js"&gt;&lt;/script&gt;</code><br>
            <code>&lt;script src="assests/order-api.js"&gt;&lt;/script&gt;</code><br>
            <code>&lt;script src="assests/auth.js"&gt;&lt;/script&gt;</code>
        </div>

        <div class="section">
            <h2>üîß Backend Status</h2>
            <button onclick="checkBackendStatus()">Check Backend Connection</button>
            <div id="statusOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>üë§ Test Authentication</h2>
            <button onclick="testRegister()">Test Register</button>
            <button onclick="testLogin()">Test Login</button>
            <button onclick="testGetUser()">Get Current User</button>
            <div id="authOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>üì¶ Test Orders</h2>
            <button onclick="testCreateOrder()">Create Test Order</button>
            <button onclick="testGetOrders()">Get All Orders</button>
            <div id="orderOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>üìç Test Tracking</h2>
            <button onclick="testCreateTracking()">Create Tracking</button>
            <button onclick="testGetTracking()">Get Tracking</button>
            <div id="trackingOutput" class="output"></div>
        </div>

        <div class="section">
            <h2>üí° Usage Examples</h2>
            <h3>Register User:</h3>
            <pre><code>const result = await authManager.signup({
    name: 'John Doe',
    email: 'john@example.com',
    password: 'password123',
    studentId: 'STU12345',
    hostelRoom: 'BH-3, A-404',
    phone: '9876543210'
});</code></pre>

            <h3>Login User:</h3>
            <pre><code>const result = await authManager.login('john@example.com', 'password123');</code></pre>

            <h3>Create Order:</h3>
            <pre><code>const result = await orderManager.createOrder({
    serviceType: 'Wash & Fold',
    pickupDate: '2024-01-15',
    pickupTime: '10:00 AM',
    deliveryDate: '2024-01-16',
    items: [{ name: 'Shirt', quantity: 5 }],
    totalAmount: 250,
    address: 'BH-3, A-404',
    phone: '9876543210'
});</code></pre>

            <h3>Get Orders:</h3>
            <pre><code>const orders = await orderManager.getOrders();</code></pre>
        </div>
    </div>

    <!-- Load Backend Integration Scripts -->
    <script src="assests/api-config.js"></script>
    <script src="assests/order-api.js"></script>
    <script src="assests/auth.js"></script>

    <script>
        // Test Functions
        async function checkBackendStatus() {
            const output = document.getElementById('statusOutput');
            output.innerHTML = 'Checking backend connection...';
            
            try {
                const response = await fetch('http://localhost:3000/api/health');
                const data = await response.json();
                output.innerHTML = `<span class="success">‚úÖ Backend is running!</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Backend is not running!</span>\n${error.message}\n\nPlease start the backend:\n1. cd backend\n2. npm install\n3. npm start`;
            }
        }

        async function testRegister() {
            const output = document.getElementById('authOutput');
            output.innerHTML = 'Testing registration...';
            
            const testUser = {
                name: 'Test User',
                email: `test${Date.now()}@example.com`,
                password: 'test123',
                studentId: `STU${Date.now()}`,
                hostelRoom: 'BH-3, A-404',
                phone: '9876543210'
            };

            try {
                const result = await authManager.signup(testUser);
                if (result.success) {
                    output.innerHTML = `<span class="success">‚úÖ Registration successful!</span>\n${JSON.stringify(result, null, 2)}`;
                } else {
                    output.innerHTML = `<span class="error">‚ùå Registration failed!</span>\n${result.message}`;
                }
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}`;
            }
        }

        async function testLogin() {
            const output = document.getElementById('authOutput');
            output.innerHTML = 'Testing login...';
            
            try {
                const result = await authManager.login('test@example.com', 'test123');
                if (result.success) {
                    output.innerHTML = `<span class="success">‚úÖ Login successful!</span>\n${JSON.stringify(result, null, 2)}`;
                } else {
                    output.innerHTML = `<span class="error">‚ùå Login failed!</span>\n${result.message}`;
                }
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}`;
            }
        }

        async function testGetUser() {
            const output = document.getElementById('authOutput');
            output.innerHTML = 'Getting current user...';
            
            try {
                const response = await apiClient.get('/auth/me');
                if (response.success) {
                    output.innerHTML = `<span class="success">‚úÖ User fetched!</span>\n${JSON.stringify(response, null, 2)}`;
                } else {
                    output.innerHTML = `<span class="error">‚ùå Failed!</span>\n${response.message}`;
                }
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}\n\nPlease login first!`;
            }
        }

        async function testCreateOrder() {
            const output = document.getElementById('orderOutput');
            output.innerHTML = 'Creating test order...';
            
            const testOrder = {
                serviceType: 'Wash & Fold',
                pickupDate: '2024-01-15',
                pickupTime: '10:00 AM',
                deliveryDate: '2024-01-16',
                items: [
                    { name: 'Shirt', quantity: 5 },
                    { name: 'Pants', quantity: 2 }
                ],
                totalAmount: 250,
                address: 'BH-3, A-404',
                phone: '9876543210',
                specialInstructions: 'Handle with care'
            };

            try {
                const result = await orderManager.createOrder(testOrder);
                if (result.success) {
                    output.innerHTML = `<span class="success">‚úÖ Order created!</span>\n${JSON.stringify(result, null, 2)}`;
                } else {
                    output.innerHTML = `<span class="error">‚ùå Failed!</span>\n${result.message}`;
                }
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}\n\nPlease login first!`;
            }
        }

        async function testGetOrders() {
            const output = document.getElementById('orderOutput');
            output.innerHTML = 'Fetching orders...';
            
            try {
                const orders = await orderManager.getOrders();
                output.innerHTML = `<span class="success">‚úÖ Orders fetched!</span>\nTotal: ${orders.length}\n${JSON.stringify(orders, null, 2)}`;
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}\n\nPlease login first!`;
            }
        }

        async function testCreateTracking() {
            const output = document.getElementById('trackingOutput');
            output.innerHTML = 'Creating tracking...';
            
            const testTracking = {
                orderNumber: 'ORD' + Date.now(),
                status: 'picked_up',
                currentLocation: 'Laundry Facility',
                estimatedDelivery: '2024-01-16',
                timeline: [
                    { status: 'Order Placed', timestamp: new Date().toISOString() }
                ]
            };

            try {
                const result = await trackingManager.createTracking(testTracking);
                if (result.success) {
                    output.innerHTML = `<span class="success">‚úÖ Tracking created!</span>\n${JSON.stringify(result, null, 2)}`;
                } else {
                    output.innerHTML = `<span class="error">‚ùå Failed!</span>\n${result.message}`;
                }
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}\n\nPlease login first!`;
            }
        }

        async function testGetTracking() {
            const output = document.getElementById('trackingOutput');
            output.innerHTML = 'Fetching tracking...';
            
            try {
                const tracking = await trackingManager.getTrackingItems();
                output.innerHTML = `<span class="success">‚úÖ Tracking fetched!</span>\nTotal: ${tracking.length}\n${JSON.stringify(tracking, null, 2)}`;
            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå Error:</span>\n${error.message}\n\nPlease login first!`;
            }
        }

        // Auto-check backend on load
        window.addEventListener('load', () => {
            checkBackendStatus();
        });
    </script>
</body>
</html>
